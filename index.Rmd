---
title: "Tablero Censo 2022"
output: 
  flexdashboard::flex_dashboard:
    logo: logo2.png
  #   theme:
  #     bg: "#FFFAFA"
  #     fg: "#101010"
  #     primary: "#a79970"
  #     base_font:
  #       google: Prompt
  #     code_font:
  #       google: JetBrains Mono
  #   orientation: columns
  #   vertical_layout: fill
  #     editor_options:
  # chunk_output_type: inline
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(sf)
library(DT)
library(leaflet)
# Install thematic and un-comment for themed static plots (i.e., ggplot2)
# thematic::thematic_rmd()
```


```{r carga-de-imagenes, include=FALSE}
 
# ![Caption for the image](path/to/image.png) 

```

El CNHPyV 2022
======================================================================

```{r}
#Imput data, tabla poblacion por depto
# viviendas
#hogares
```


Column {data-width=850 .tabset}
---------------------------------------------------------------------

### El Censo

El Censo Nacional de Población, Hogares y Viviendas de la Argentina se realizó en dos instancias. En la primera, se habilitó un cuestionario digital que estuvo disponible para completar entre el 16 de marzo y el 18 de mayo. En una segunda instancia, se implementó la modalidad presencial a través del barrido territorial, que se llevó a cabo el miércoles 18 de mayo, el Día del Censo, declarado feriado nacional.

![Censo 2022](encabezado_indec.png){#id .class width=70% height=70%}

La Direccion General de Estadisticas y Censos, fue la responsable de llevar adelante el Censo Nacional de Población, Hogares y Viviendas 2022 (Censo 2022) en Santiago del Estero, fruto de un arduo trabajo colectivo, realizado año a año. Estas tareas previas implicaron entre otras, la consulta y pareo de registros administrativos, estimaciones de población,y entre las mas relevantes, la actulizacion cartografica. Puede consultar en el apartado [La Cartografía](#la-cartografía).  

El Censo 2022 se llevó a cabo por primera vez en la Argentina con una estrategia bimodal: un cuestionario digital y el tradicional barrido territorial con cuestionarios en papel (cédulas censales). El barrido territorial implicó la movilizacion de mas de 16.000 personas en toda la geografia provincial. Sobre el operativo, y mas puede consultar el [El Operativo](#el-operativo).

Puede consultar los resultados definitivos en las publicaciones temáticas en formato `pdf` y los tabulados sencillos y cuadros en formato `.xlsx` que pone a disposición El Instituto Nacional de Estadística y Censos (INDEC), tanto en el [Geoportal](https://portalgeoestadistico.indec.gob.ar/), como en el sitio del [Censo 2022](https://censo.gob.ar/), como en la misma pagina de INDEC en el área [Censos](https://www.indec.gob.ar/indec/web/Nivel4-Tema-2-41-165)

Ante las limitaciones de los tabulados,y el interes de contar con mejores precisiones en las estimaciones y comparaciones temporales de la poblacion, las variaciones entre las rondas censales, asi como analizar y trabajar sobre las condiciones de posibilidad de lograr mayor desagregacion geografica en las estadisticas publicas, a la vez uqe contar con mejor informacion en marco de interoperabilidad y de altos estandar de calidad, la DGEyC ha conformado el SIGSE, Sistema de Informacion Geografica Corporativo de la Dir. General de Estadisticas y Censos. Consulte mas en el apartado [SIGSE](#el-sigse)


### Santiago del Estero en 2022

```{r tabla-resultados, include=FALSE}
pob_depto <- read.csv2("~/GitHub/carto_censal_tablero/data/pob_total_depto_80_30.csv")
```

Descargue la Tabla en formato Excel

```{r}
datatable(pob_depto,
          caption = "Poblacion Total en viviendas particulares Censos 1980 - 2022, y estimacion a 2030",
          rownames = FALSE,
          extensions = "Buttons", 
options = list(dom = 'Bfrtip', buttons = c('excel')))
```

### La Poblacion

Grafico de evolucion de la poblacion

```{r data-wrangling, include=FALSE}
pob_tot_censos <- pob_depto |> 
  pivot_longer(
    cols = starts_with("censo"),
    names_to = "Censo",
    names_prefix = "censo.",
    values_to = "Pob",
    values_drop_na = TRUE
  )
pob_tot_censos
```

```{r grafico1}
grafico1 <- pob_tot_censos |> 
  group_by(Censo) |> 
  summarise(pob = sum(Pob)) |> 
  ggplot(aes(x = Censo, y= pob )) +
  geom_bar(stat = "identity")+
  theme_minimal()+
  labs(
    title = "Poblacion Total en Viviendas Residenciales"
  )

grafico1
```

Column {data-width=150}
----------------------------------------------------------------------
```{r indicadores-key, include=FALSE}
pob_total <- sum(pob_tot_censos$Pob[pob_tot_censos$Censo == 2022])
pob_total
```

### Poblacion Total
```{r}
valueBox(1060906,caption = "Personas", icon = "fa-users", color = "grey" )
```

### Varones
```{r}
valueBox(521543,caption = "Varones", icon = "fa-male", color = "lightblue" )
```

### Mujeres
```{r}
valueBox(539363,caption = "Mujeres", icon = "fa-female", color = "lightpink" )
```

### Viviendas
```{r}
valueBox(1057752,caption = "Pers.Viv.Part", icon = "fa-home", color = "lightgrey" )
```
### Viv Colectivas
```{r}
valueBox(3099,caption = "Pers. Viv.Col", icon = "fa-building-o", color = "lightgrey" )
```

La Cartografía 
=======================================================================

```{r MAPABASE, include=FALSE}
Argenmap <- 'https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{-y}.png'

Argenmap_gris <- 'https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/mapabase_gris@EPSG%3A3857@png/{z}/{x}/{-y}.png'

Argenmap_topografico <- 'https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/mapabase_topo@EPSG%3A3857@png/{z}/{x}/{-y}.png'

Argenmap_oscuro <- 'https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/argenmap_oscuro@EPSG%3A3857@png/{z}/{x}/{-y}.png'

Argenmap_hibrido <- 'https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/mapabase_hibrido@EPSG%3A3857@png/{z}/{x}/{-y}.png'
```

Column {data-width=850 .tabset}
-----------------------------------------------------------------------

```{r data-mapa, include=FALSE}
pais_86 <- st_read("~/Proyecto_gis_carto_censal_2022/pais86/pais86220.shp")

st_crs(pais_86)

pais_86 <- st_transform(pais_86,crs = 4326)
  
```

```{r data-mapa-fracciones, include=FALSE}
#disolver por fracciones de una manera sencilla con spatialEco
#Viejo problema de datos devuelve un radio fuera de lugar entre Banda y Figueroa
global_fracciones_pais86 <- geojsonsf::geojson_sf("~/GitHub/carto_censal_tablero/geodata/fracciones_global_datos.geojson")
st_crs(global_fracciones_pais86)
#global_fracciones_pais86 <- st_transform(fracciones_pais86, 4326)
#plot(global_fracciones_pais86)
```

```{r data-mapa-vias, include=FALSE}

vias23 <- st_read("~/Proyecto_gis_carto_censal_2022/vias/vias_circulacion_2023.shp")
st_crs(vias23)
```


```{r mapa, include=FALSE}
# vectorial_pais86 <- leaflet() |> 
#   addTiles(group = "OSM") |> 
#   addTiles(Argenmap, group = "Argenmap") |> 
#   addPolygons(data = pais_86) |> 
#   addLayersControl(baseGroups = c("OSM", "Argenmap"))
# vectorial_pais86
```


```{r data-mapa-precenso}
# precenso_provincia
precenso_depto <- geojsonsf::geojson_sf("~/GitHub/carto_censal_tablero/geodata/precenso_viviendas.geojson")
# precenso_radios

```

```{r data-mapa-rad-urbanos, include=FALSE}
radios_urbanos_con_datos <- geojsonsf::geojson_sf("~/GitHub/carto_censal_tablero/geodata/radios_urbanos_datos.geojson")
envolventes_con_datos <- geojsonsf::geojson_sf("~/GitHub/carto_censal_tablero/geodata/envolventes.geojson")
glimpse(radios_urbanos_con_datos)
glimpse(envolventes_con_datos)
```


### Pais86
Conocida en la jerga como *pais86* correponde a la cartografía censal resultante del sistema de segmentacion, y agrupamiento por radios y las fracciones censales. Su construccion no solo se adecua a los estandares nacionales y los consensos interprovinciales y nacionales, sino que requiere tambien un profundo analisis de la geografia provincial, el patron de asentamientos humanos, y los cambios recientes en el uso de la tierra.

```{r mapa-pais86}
mapa1 <- leaflet() |> 
  setView(lng = -63,25, lat =-27.67 , zoom = 7) |> 
  addTiles() |> 
  addTiles(Argenmap, group = "Argenmap") |> 
  addTiles(Argenmap_gris, group = "Argenmap Gris") |>
  addTiles(Argenmap_hibrido, group = "Argenmap Hibrido") |>
  addTiles(Argenmap_oscuro, group = "Argenmap Oscuro") |>
  addTiles(Argenmap_topografico, group = "Argenmap Topo") |> 
  addPolygons(data =  pais_86, group = "Pais86",
              stroke = .4,
              color = "black",
              fillColor = "grey",
              fillOpacity = .25,
              popup = pais_86$LINK) |>
  addLayersControl(overlayGroups = c("Pais86"),
                   baseGroups = c("Argenmap",
                                  "Argenmap Gris",
                                  "Argenmap Hibrido",
                                  "Argenmap Oscuro",
                                  "Argenmap Topo",
                                  "OSM")
                   )
mapa1
```

### Fracciones
Una desicion interesante es que las fracciones censales son las mismas que en 2010, y al estar disponibles lo Microdatos pronto será posible realizar comparaciones intercensales, con el cuidado del caso, con un desagregacion espacial estrictamente comparable.

```{r mapa-fracciones}
mapa2 <- leaflet(st_zm(global_fracciones_pais86)) |> 
  setView(lng = -63,25, lat =-27.67 , zoom = 7) |> 
  addPolygons(
    group = "Fracciones",
    stroke = .3,
    color = "yellow",
    fillColor = "lightyellow",
    fillOpacity = 0.4,
    popup = paste0("Poblacion est: ", global_fracciones_pais86$pob_tot)
  ) |> 
  addTiles() |> 
  addLayersControl(overlayGroups = c("Fracciones")
                   )
mapa2
```

### Vias de Circulacion
Uno de los productos cartograficos mas ricos de los trabajo precensales, y necesarios para la segmentacion (ruta del encuestador) es la traza vial que puede realizarse a pie. Conocida como __callejero__ permite avanzar hacia las ciudades digitales y tiene innumerables usos, principalmente el de determinar la ubicacion y distancias relativas entre objetos geograficos. 

```{r mapa-vias}
mapa3 <- leaflet() |> 
  setView(lng = -63,25, lat =-27.67 , zoom = 7) |> 
  addTiles() |> 
  addPolylines(data = vias23,
               stroke = .2,
               color = "black",
               popup = vias23$NOMENCLA)
mapa3
```

### Envolventes Urbanas

La union de los Radios Urbanos permite trazar una envolvente urbana. Luego estimar para este nivel su patron de crecimiento, y diseñar los relevamientos e incluso las politicas de gobierno local basados en este conteo de viviendas y poblacion. 

```{r mapa-radios}
mapa5 <- leaflet() |>
  setView(lng = -63,25, lat =-27.67 , zoom = 7) |> 
  addTiles() |> 
  addPolygons(data =  envolventes_con_datos,
              stroke = .1,
              fillOpacity = .8,
              popup = paste0("Poblacion estimada: ", envolventes_con_datos$fracc_pob),
              group = "Envolventes") |> 
  addPolygons(data = radios_urbanos_con_datos,
              stroke = .2,
              color = "lightblue",
              fillOpacity = 0,
              popup = paste0("Viviendas encuestadas: ",radios_urbanos_con_datos$R2_viv_enc),
              group = "Radios urbanos") |> 
  addLayersControl(overlayGroups = c("Envolventes", "Radios urbanos"))
mapa5
```



### Precenso

El [Precenso de Viviendas 2019-2021](https://precensodeviviendas.indec.gob.ar/) contiene datos de viviendas esperadas disponible por nivel departamento,fraccion y radio. Aunque la cartografia no es del todo coherente con la utilizada en el censo de poblacion, se considera que es una fuente de consulta necesaria.

```{r mapa-precenso}
mapa4 <- leaflet() |> 
  setView(lng = -63,25, lat =-27.67 , zoom = 7) |> 
  addTiles() |> 
  addPolygons(data = precenso_depto,
              stroke = .4,
              color = "blue",
              fillColor = "lightblue",
              fillOpacity = .4,
              popup = paste0("Total de Viviendas esperadas: ", precenso_depto$ind01))
mapa4
```

### Localidades


Column {data-width=150}
-----------------------------------------------------------------------
```{r tabla-de-geometrias, include=FALSE}
pais_86_datos <- st_drop_geometry(pais_86)
glimpse(pais_86_datos)
pais_86_datos <- pais_86_datos |> 
  mutate(
    fraccion_concat = paste0(PROV, DEPTO, FRAC),
    radio_concat = paste0(PROV, DEPTO, FRAC, RADIO)
  )
```

```{r cuentas-pais86, include=FALSE}

radios_totales <- n_distinct(pais_86_datos$LINK)
radios_urbanos <- n_distinct(pais_86_datos$radio_concat[pais_86_datos$TIPO=="U"])
radios_mixtos <- n_distinct(pais_86_datos$radio_concat[pais_86_datos$TIPO=="M"])
radios_rurales<- n_distinct(pais_86_datos$radio_concat[pais_86_datos$TIPO=="R"])

#---

unicas_vias23 <- nrow(st_drop_geometry(vias23))
unicas_vias23
```


### Radios Totales
```{r}
valueBox(radios_totales, 
         caption = "Total de Radios", icon="fa-check-square-o", color = "lightyellow")
```
### Radios Urbanos
```{r}
valueBox(radios_urbanos, 
         caption = "Radios Urbanos", icon="fa-check-circle-o", color = "lightgrey")
```
### Radios Mixtos
```{r}
valueBox(radios_mixtos, 
         caption = "Radios Mixtos", icon="fa-check-circle-o", color = "#ffe599")
```
### Radios Rurales
```{r}
valueBox(radios_rurales, 
         caption = "Radios Rurales", icon="fa-check-circle-o", color = "#f9cb9c")
```
### Vias de Circ.
```{r}
valueBox(unicas_vias23, 
         caption = "Calles", icon="fa-th", color = "lightgrey")
```



El Operativo
======================================================================

El Censo 2022 comenzó el 16 de marzo de 2022 en todo el territorio argentino, para un total estimado de 17 millones de viviendas (en nuestra provincia al menos unas 270.000 viviendas). A partir de ese día y hasta el 18 de mayo a las 8:00 hs se realizó el censo digital (que luego se extendió una semana); el 18 de mayo entre las 9 y las 18 hs se llevó a cabo el operativo de campo. Una semana antes había comenzado el operativo en las vastas zonas rurales de la provincia. Mas de 150 sedes censales, montadas en escuelas, comisiones de fomento, clubes, etc. a lo largo de 200 localidades, puestos y parajes.  
Luego del 18 de mayo al 24 se extendieron las tareas de *recupero* censal, con minuciosa observacion del desempeño del operativo.

Column {data-width=250}
-----------------------------------------------------------------------
```{r tabla-estructura-censal, include=FALSE}
est_censal <- readxl::read_xlsx(path = "~/GitHub/carto_censal_tablero/estructura censal.xlsx")
glimpse(est_censal)

```
```{r lista-est, include=FALSE}
estructura_censal <- as.data.frame(table(est_censal$`Nombre Rol`))

estructura_censal
```

### Tabla Estructura Censal

```{r}
datatable(estructura_censal,
          caption = "Estructura censal - Operativo")
```

Column {data-width=750} {.tabset}
-----------------------------------------------------------------------
### Listado de Localidades censales

Consulte por medio de filtros para cada columna el listado de localidades censales 2022.
```{r tabla-localidades, include=FALSE}

localidades_indec_2024 <- read.csv2("~/GitHub/carto_censal_tablero/data/listado_localidades.csv",
                                    fileEncoding = "UTF8"
                                    )
localidades_indec_2024
```
```{r}
datatable(localidades_indec_2024,
          rownames = FALSE,
          filter = list(position = 'top', clear = FALSE),
  options = list(search = list(regex = TRUE, caseInsensitive = TRUE, search = 'M[ae]'),
        pageLength = 5),
  caption = "Localidades Censo 2022, Listado actualizado a feb 2024",
)
```


```{r data-table-error, include=FALSE}
# datatable(tabla_bahra,
#           extensions = 'Buttons', options = list(
#     dom = 'Bfrtip',
#     buttons = c('print'),
#     list(search = list(regex = TRUE, caseInsensitive = TRUE, search = 'M[ae]'),
#         pageLength = 5)
#   ))

  # list(
  #   dom = 'Bfrtip',
  #   buttons = c('print')
  # ),
# options = list(
#     dom = 'Bfrtip',
#     buttons = c('copy', 'csv', 'excel', 'pdf', 'print')
```
### BAHRA

Busque por departamento o localidad o codigo, y exporte un excel con los datos suficientes para orientar el registro.
```{r bahra, include=FALSE}
bahra_sde <- st_read("~/bahra_puntos/bahra.shp")
```
```{r bahra-tabla, include=FALSE}
cols_bahra <- c(5:8, 13:14, 17)
tabla_bahra <- st_drop_geometry(bahra_sde) |> 
  select(cols_bahra)
#select(allof(cols))
```
```{r data-table-bahra}
datatable(tabla_bahra,
          #caption = "Base de Asentamientos Humanos Republica Argentina - Santiago del Estero y aledañas",
          extensions = 'Buttons',
          rownames = FALSE,
         # filter = list(position = 'top', clear = FALSE),
          options = list(dom = 'Bfrtip', buttons = c('excel'))
)
```


### Reglas y Codigos

En el Listado de INDEC puede diferenciar las localidades segun cuenten Con Gobierno local o sean Sin Gobierno local y Cabecera de departamento.

El sistema de codigos ademas indica, en 2 posiciones la provincia,en 3 el departamento, y en 3 las localidades.  

Así un codigo de 5 posiciones indica un departamento (uno de 7 podria indicar el radio censal), y uno de 8 posiciones a la localidad, puesto o paraje. Esta es la maxima desagregacion posible a una entidad univoca.Conforme al sistema de codigos geograficos o Unidades Geoestadisticas, para mas consulte [INDEC](https://geoservicios.indec.gob.ar/codgeo/index.php?pagina=inicio) 

La Base de Asentamientos Humanos de la República Argentina (BAHRA) es la primera base de datos oficial y normalizada de localidades, parajes, entidades y bases antárticas del territorio nacional; donde se identifica unívocamente a todos los asentamientos humanos, registrando el nombre, coordenadas y código único, entre otros atributos. Consulte en [BAHRA](http://www.bahra.gob.ar/index.html)

El SIGSE
======================================================================

Column {.tabset}
---------------------------------------------------------------------

### SIG Corporativo 

Montar un SIG Corporativo en el ámbito de la DGEyC en base a la producción, normalización y actualización de información Geoespacial propia y de socios terceros estratégicos, en el marco de consensos técnicos, organizacionales y normativos (fundamentos IDE) orientado a la coordinación y eficiencia de la gestión pública y la toma de decisiones a nivel provincial y de gobiernos locales.

**Diagnóstico y problemas a abordar**

- Reducir la redundancia de información – evitar la duplicación, superposición y contradicciones en la información pública oficial.

- Mejorar la calidad de cartografía básica asociada a límites jurídico-políticos-administrativos que deben ordenarse; como la armonización entre fuentes de datos oficiales nacionales y provinciales, entre organismos nacionales, y entre ellos y los provinciales, y hacia el interior de estos. Áreas claves como los catastros rurales, los ejidos municipales, el ordenamiento territorial, que requieren de la cooperación de actores e interoperabilidad de información.

- Mejorar y difundir de manera centralizada la localización y nombramiento de entidades espaciales como regiones, ciudades, localidad, parajes y puestos. Tipo de gobierno y autoridades, y acceso a información al usuario. Gobiernos locales, y asentamientos humanos.

- Promover cartografías colaborativas en la sociedad en ejes como la historia local, medioambiente, cultura y turismo e innovar en el ámbito educativo, incursionando en el pensamiento espacial de la comunidad educativa

- Actualizar y mantener la información relativa a Infraestructura de servicios y necesaria para la gestión del riesgo, preservando la coherencia con las diversas fuentes productoras y bajo altos estándares de información geoespacial.

- Generar acuerdos en áreas claves de gobierno, con productos estables de mediano y largo plazo. En Salud al igual que en Educación, es preciso georreferenciar establecimientos y servicios

### Productos a desarrollar

-> Trabaja con nosotros
enviar un mail a dgeyccomunicacionydifusion@gmail.com 


**Trabajo con Gobiernos Locales**

- Municipalidad de Monte Quemado
- Municipalidad de Sumampa
- Comisión de Villa Robles
- Comisiones Municipales de Departamento Banda

Capas sobre censos 

-	Callejeros
-	Localidades censales con datos (2010 -2022)
-	Radios (Urbanos, envolventes)
-	Fracciones
-	Departamento
-	Pre-censo vivienda

Capas censos históricos:

-	Cartografía censal 2001-2022  
-	Radios con vivienda y población 2001 y 2010  
-	Departamento con población 1980, 1991, 2001, 2010  
-	Cartografía histórica


Capas de indicadores económicos:

-	Estimaciones agrícolas
-	SIPA + Producción
-	Establecimientos económicos


Capas Agro-forestal

-	Desmontes Redd+ 
-	MAPBioMas
-	Ordenamientos Territorial 2009 y 2015

Capas propias DPE Operativos:

-	Cartografía censal (pais86) de 2010 y de 2022
-	Localidades con Nomenclador
-	Localidades de Encuestas
-	Envolventes de localidades + callejero
-	Establecimientos
- Muestreos

Capas de socios DPE

-	Seguridad
-	Salud 
- Eduación
-	Obras Sanitarias
-	Obras publicas
- Catastro

### Ley de Estadistica

Amparados Ley 6745 de 6 julio de 2005. [Disponible aquí](https://drive.google.com/file/d/17GARtpDxzqrmU3eJ0Eti71QNvpLs6iEN/view?usp=sharing)

La DGEyC es el organismo rector del Sistema Estadistico, Demografico, Economico y Social de la Provincia (SEDES)

Esta responsabilidad y facultades potencian el rol de la DGEyC

La Dirección Provincial de Estadísticas y Censos cuenta con

✓ Recursos Humanos

✓ Información abundante y de calidad

✓ Garantía de Secreto estadístico

✓ Estándares de Alto Nivel

✓ Estabilidad de mediano y largo plazo  


De esta manera SIGSE permitirá
• Relevar, capturar, almacenar y normalizar información georreferenciada  

• Así como brindar asistencia técnica y capacitación  

• Incrementar el volumen y calidad de información pública georreferenciada  

• Facilitar la interoperabilidad bajo estándares de alta calidad  

• Ajustar a derechos y obligaciones el uso de la información, garantizando el secreto estadístico  

• Brindar soporte a la planificación y toma de decisiones  

• Dotar de estabilidad proyectos de largo plazo y largo alcance territorial  


